"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4209],{69980:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(1413),i=n(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zm-377.1-44.1c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-.6-.6-1.3-1.2-2-1.7l-78.2-78.2a9.11 9.11 0 00-12.8 0l-48 48a9.11 9.11 0 000 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256zm12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"}}]},name:"bg-colors",theme:"outlined"},o=n(42135),l=function(e,t){return i.createElement(o.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:a}))};l.displayName="BgColorsOutlined";var s=i.forwardRef(l)},88484:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(1413),i=n(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},o=n(42135),l=function(e,t){return i.createElement(o.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:a}))};l.displayName="UploadOutlined";var s=i.forwardRef(l)},80275:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(1413),i=n(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M759 335c0-137-111-248-248-248S263 198 263 335c0 82.8 40.6 156.2 103 201.2-.4.2-.7.3-.9.4-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00136 874.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C356 614.2 431 583 511 583c137 0 248-111 248-248zM511 507c-95 0-172-77-172-172s77-172 172-172 172 77 172 172-77 172-172 172zm105 221h264c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H703.5l47.2-60.1a8.1 8.1 0 001.7-4.9c0-4.4-3.6-8-8-8h-72.6c-4.9 0-9.5 2.3-12.6 6.1l-68.5 87.1c-4.4 5.6-6.8 12.6-6.8 19.8.1 17.7 14.4 32 32.1 32zm240 64H592c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h176.5l-47.2 60.1a8.1 8.1 0 00-1.7 4.9c0 4.4 3.6 8 8 8h72.6c4.9 0 9.5-2.3 12.6-6.1l68.5-87.1c4.4-5.6 6.8-12.6 6.8-19.8-.1-17.7-14.4-32-32.1-32z"}}]},name:"user-switch",theme:"outlined"},o=n(42135),l=function(e,t){return i.createElement(o.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:a}))};l.displayName="UserSwitchOutlined";var s=i.forwardRef(l)},1974:function(e,t,n){var r=n(47568),i=n(14924),a=n(26042),o=n(69396),l=n(29815),s=n(34051),c=n.n(s),u=n(85893),d=n(67294),p=n(84551),f=n(16536),h=n(63922),v=n(67691),g=n(64082),x=n(18429),m=n(40730),Z=n(4657),j=n(9669),y=n.n(j),w=n(86501);t.Z=function(e){var t,n=e.page,s=void 0===n?"admin":n,j=p.Z.Dragger,k=(0,d.useContext)(m.V),b=k[0],C=(k[1],(0,d.useContext)(Z.Y)),M=C[0],S=C[1],_=(0,d.useState)(!1),z=_[0];_[1],(0,d.useEffect)((function(){var e=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y().get("/media");case 3:t=e.sent.data,S((function(e){return(0,o.Z)((0,a.Z)({},e),{images:t})})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var O={name:"file",action:"".concat("http://localhost:8000/api/","upload-image-file"),multiple:!0,headers:{Authorization:"Bearer ".concat(b.token)},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(f.ZP.success("".concat(e.file.name," file uploaded successfully")),S({images:(0,l.Z)(M.images).concat([e.file.response]),selected:e.file.response,showMediaModal:!1})):"error"===e.file.status&&f.ZP.error("".concat(e.file.name," file upload failed."))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}},E=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y().delete("/media/".concat(t));case 3:n=e.sent.data,console.log(n),n.ok&&S((0,o.Z)((0,a.Z)({},M),{images:M.images.filter((function(e){return e._id!=t})),selected:null})),w.Am.error("Image Deleted successfully"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)(j,(0,o.Z)((0,a.Z)({},O),{accept:"image/*",children:[(0,u.jsx)("p",{className:"ant-upload-drag-icon",children:(0,u.jsx)(g.Z,{})}),(0,u.jsx)("p",{className:"ant-upload-text",style:{height:"85px"},children:"Click or drag file to this area to upload"})]})),(0,u.jsx)("br",{})]}),(0,u.jsxs)("div",{style:{textAlign:"center"},children:[null===M||void 0===M||null===(t=M.images)||void 0===t?void 0:t.map((function(e){var t,n,r;return(0,u.jsxs)(h.Z,{children:[(0,u.jsx)(v.Z,{onClick:function(){return S((0,o.Z)((0,a.Z)({},M),{selected:e}))},preview:z,style:(r={paddingTop:5,paddingRight:5},(0,i.Z)(r,"paddingTop",5),(0,i.Z)(r,"marginBottom",50),(0,i.Z)(r,"height","100px"),(0,i.Z)(r,"width","100px"),(0,i.Z)(r,"objectFit","cover"),(0,i.Z)(r,"cursor","pointer"),r),src:e.url}),(0,u.jsx)("br",{}),"author"===s&&(null===e||void 0===e||null===(t=e.postedBy)||void 0===t?void 0:t._id)==(null===b||void 0===b||null===(n=b.user)||void 0===n?void 0:n._id)||"admin"===s?(0,u.jsx)(x.Z,{onClick:function(){return E(e._id)},style:{color:"#f5222d "}}):""]})})),(0,u.jsx)("br",{})]})]})}},25030:function(e,t,n){var r=n(85893),i=(n(67294),n(63456)),a=n(1974),o=n(74687),l=o.Z.TabPane;t.Z=function(){return(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(l,{tab:"Upload File",children:(0,r.jsx)(i.Z,{})},"1"),(0,r.jsx)(l,{tab:"Media Library",children:(0,r.jsx)(a.Z,{})},"2")]})}},77161:function(e,t,n){var r=n(47568),i=n(26042),a=n(69396),o=n(29815),l=n(34051),s=n.n(l),c=n(85893),u=n(67294),d=n(9835),p=n(71230),f=n(15746),h=n(79531),v=n(71577),g=n(67691),x=n(14538),m=n(6235),Z=n(21364),j=n(9669),y=n.n(j),w=n(86501),k=n(11163),b=n(88484),C=n(25030),M=n(4657),S=d.Z.Option;t.Z=function(e){var t,n,l=e.sentby,j=void 0===l?"admin":l,_=(0,u.useContext)(Z.N),z=_[0],O=(_[1],(0,u.useContext)(M.Y)),E=O[0],N=O[1],T=(0,u.useState)(""),P=T[0],A=T[1],B=(0,u.useState)(""),H=B[0],I=B[1],V=(0,u.useState)(""),R=V[0],D=V[1],F=(0,u.useState)([]),L=F[0],U=F[1],q=(0,u.useState)([]),G=q[0],J=q[1],K=(0,u.useState)({}),Y=K[0],W=K[1],Q=(0,u.useState)(!1),X=Q[0],$=Q[1],ee=(0,u.useState)(!0),te=ee[0],ne=ee[1],re=(0,k.useRouter)();(0,u.useEffect)((function(){ie()}),[null===re||void 0===re||null===(t=re.query)||void 0===t?void 0:t.slug]),(0,u.useEffect)((function(){ae()}),[]);var ie=function(){var e=(0,r.Z)(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y().get("/post/".concat(re.query.slug));case 3:t=e.sent.data,console.log("GOT POST FOR EDIT",t),I(t.post.title),D(t.post.text),W(t.post.featuredImage),A(t.post._id),n=[],t.post.categories.map((function(e){return n.push(e.name)})),U(n),ne(!1),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=(0,r.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y().get("/categories");case 3:t=e.sent.data,J(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=(0,r.Z)(s().mark((function e(){var t,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,ne(!0),e.next=5,y().put("/edit-post/".concat(P),{title:H,content:R,categories:L,featuredImage:(null===E||void 0===E||null===(t=E.selected)||void 0===t?void 0:t._id)?null===E||void 0===E||null===(n=E.selected)||void 0===n?void 0:n._id:(null===Y||void 0===Y?void 0:Y._id)?Y._id:void 0});case 5:(null===(r=e.sent.data)||void 0===r?void 0:r.error)?(w.Am.error(null===r||void 0===r?void 0:r.error),ne(!1)):(w.Am.success("Post Updated successfully"),N((0,a.Z)((0,i.Z)({},E),{selected:null})),re.push("/".concat(j,"/posts"))),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),w.Am.error("Post update failed. Try again."),ne(!1);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return(0,c.jsxs)(p.Z,{children:[(0,c.jsxs)(f.Z,{span:14,offset:1,children:[(0,c.jsx)("h1",{children:"Edit post"}),(0,c.jsx)(h.Z,{size:"large",value:H,placeholder:"Give your post a title",onChange:function(e){I(e.target.value),localStorage.setItem("post-title",JSON.stringify(e.target.value))}}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),te?(0,c.jsx)("div",{children:" Loading..."}):(0,c.jsx)(m.M,{apiKey:"g7wekghh9n4a5vw9pjog2yglr9kgert1sy9zlxcxvnyj0o9n",init:{selector:"textarea",skin:"oxide-dark",content_css:"dark",menubar:!0,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","code","help","wordcount"],toolbar:"undo redo | link image | code | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }",file_picker_types:"file image media",block_unsupported_drop:!1},initialValue:"Welcome to NightKing-CMS... Start Bloggin !!",onEditorChange:function(e){D(e);localStorage.setItem("post-content",JSON.stringify(e))}}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{})]}),(0,c.jsxs)(f.Z,{span:6,offset:1,children:[(0,c.jsx)(v.Z,{style:{margin:"10px 0px 10px 0px",width:"100%"},onClick:function(){return $(!0)},children:"Preview"}),(0,c.jsxs)(v.Z,{style:{margin:"10px 0px 10px 0px",width:"100%"},onClick:function(){return N((0,a.Z)((0,i.Z)({},E),{showMediaModal:!0}))},children:[(0,c.jsx)(b.Z,{})," Featured Image"]}),(0,c.jsx)("h4",{children:"Categories"}),(0,c.jsx)(d.Z,{mode:"multiple",allowClear:!0,placeholder:"Select categories",style:{width:"100%"},onChange:function(e){return U(e)},value:(0,o.Z)(L),children:G.map((function(e){return(0,c.jsx)(S,{children:e.name},e.name)}))}),(null===E||void 0===E?void 0:E.selected)?(0,c.jsx)("div",{style:{marginTop:"15px"},children:(0,c.jsx)(g.Z,{width:"100%",src:null===E||void 0===E||null===(n=E.selected)||void 0===n?void 0:n.url})}):(null===Y||void 0===Y?void 0:Y.url)?(0,c.jsx)("div",{style:{marginTop:"15px"},children:(0,c.jsx)(g.Z,{width:"100%",src:null===Y||void 0===Y?void 0:Y.url})}):"",(0,c.jsx)(v.Z,{loading:te,style:{margin:"10px 0px 10px 0px",width:"100%"},type:"primary",onClick:oe,children:"Publish"})]}),(0,c.jsxs)(x.Z,{title:"Preview",centered:!0,visible:X,onOk:function(){return $(!1)},onCancel:function(){return $(!1)},width:720,footer:null,children:[(0,c.jsx)("h1",{children:H}),(0,c.jsx)(m.M,{dark:"light"!==z,initialValue:R,init:{readOnly:!0}})]}),(0,c.jsx)(x.Z,{visible:E.showMediaModal,title:"Media",onOk:function(){return N((0,a.Z)((0,i.Z)({},E),{showMediaModal:!1}))},onCancel:function(){return N((0,a.Z)((0,i.Z)({},E),{showMediaModal:!1}))},width:720,footer:null,children:(0,c.jsx)(C.Z,{})})]})}}}]);