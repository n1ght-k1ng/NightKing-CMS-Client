"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3085],{1974:function(e,n,t){var r=t(47568),i=t(14924),a=t(26042),s=t(69396),l=t(29815),o=t(34051),u=t.n(o),c=t(85893),d=t(67294),p=t(84551),v=t(16536),x=t(63922),f=t(67691),g=t(64082),h=t(18429),m=t(40730),Z=t(4657),j=t(9669),b=t.n(j),y=t(86501);n.Z=function(e){var n,t=e.page,o=void 0===t?"admin":t,j=p.Z.Dragger,k=(0,d.useContext)(m.V),C=k[0],S=(k[1],(0,d.useContext)(Z.Y)),w=S[0],_=S[1],A=(0,d.useState)(!1),B=A[0];A[1],(0,d.useEffect)((function(){var e=function(){var e=(0,r.Z)(u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b().get("/media");case 3:n=e.sent.data,_((function(e){return(0,s.Z)((0,a.Z)({},e),{images:n})})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var N={name:"file",action:"".concat("http://localhost:8000/api/","upload-image-file"),multiple:!0,headers:{Authorization:"Bearer ".concat(C.token)},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(v.ZP.success("".concat(e.file.name," file uploaded successfully")),_({images:(0,l.Z)(w.images).concat([e.file.response]),selected:e.file.response,showMediaModal:!1})):"error"===e.file.status&&v.ZP.error("".concat(e.file.name," file upload failed."))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}},z=function(){var e=(0,r.Z)(u().mark((function e(n){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b().delete("/media/".concat(n));case 3:t=e.sent.data,console.log(t),t.ok&&_((0,s.Z)((0,a.Z)({},w),{images:w.images.filter((function(e){return e._id!=n})),selected:null})),y.Am.error("Image Deleted successfully"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n){return e.apply(this,arguments)}}();return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)(j,(0,s.Z)((0,a.Z)({},N),{accept:"image/*",children:[(0,c.jsx)("p",{className:"ant-upload-drag-icon",children:(0,c.jsx)(g.Z,{})}),(0,c.jsx)("p",{className:"ant-upload-text",style:{height:"85px"},children:"Click or drag file to this area to upload"})]})),(0,c.jsx)("br",{})]}),(0,c.jsxs)("div",{style:{textAlign:"center"},children:[null===w||void 0===w||null===(n=w.images)||void 0===n?void 0:n.map((function(e){var n,t,r;return(0,c.jsxs)(x.Z,{children:[(0,c.jsx)(f.Z,{onClick:function(){return _((0,s.Z)((0,a.Z)({},w),{selected:e}))},preview:B,style:(r={paddingTop:5,paddingRight:5},(0,i.Z)(r,"paddingTop",5),(0,i.Z)(r,"marginBottom",50),(0,i.Z)(r,"height","100px"),(0,i.Z)(r,"width","100px"),(0,i.Z)(r,"objectFit","cover"),(0,i.Z)(r,"cursor","pointer"),r),src:e.url}),(0,c.jsx)("br",{}),"author"===o&&(null===e||void 0===e||null===(n=e.postedBy)||void 0===n?void 0:n._id)==(null===C||void 0===C||null===(t=C.user)||void 0===t?void 0:t._id)||"admin"===o?(0,c.jsx)(h.Z,{onClick:function(){return z(e._id)},style:{color:"#f5222d "}}):""]})})),(0,c.jsx)("br",{})]})]})}},25030:function(e,n,t){var r=t(85893),i=(t(67294),t(63456)),a=t(1974),s=t(74687),l=s.Z.TabPane;n.Z=function(){return(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(l,{tab:"Upload File",children:(0,r.jsx)(i.Z,{})},"1"),(0,r.jsx)(l,{tab:"Media Library",children:(0,r.jsx)(a.Z,{})},"2")]})}},3085:function(e,n,t){var r=t(47568),i=t(26042),a=t(69396),s=t(34051),l=t.n(s),o=t(85893),u=t(67294),c=t(40730),d=t(71230),p=t(15746),v=t(86871),x=t(79531),f=t(9835),g=t(71577),h=t(9669),m=t.n(h),Z=t(86501),j=t(11163),b=t(4657),y=t(25030);n.Z=function(e){var n,t,s=e.page,h=void 0===s?"admin":s;console.log("Enter Function");var k=(0,u.useContext)(c.V),C=k[0],S=k[1],w=(0,u.useContext)(b.Y),_=w[0],A=(w[1],(0,u.useState)("")),B=A[0],N=A[1],z=(0,u.useState)(""),E=z[0],F=z[1],q=(0,u.useState)(""),D=q[0],O=q[1],T=(0,u.useState)(""),U=T[0],I=(T[1],(0,u.useState)()),M=I[0],P=I[1],Y=(0,u.useState)({}),J=Y[0],L=Y[1],R=(0,u.useState)(""),V=R[0],W=R[1],G=(0,u.useState)(!1),H=G[0],K=G[1],Q=(0,j.useRouter)();(0,u.useEffect)((function(){var e=function(){var e=(0,r.Z)(l().mark((function e(){var n,t,r,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"62f46bff3715daa70c0d5849"!==(null===Q||void 0===Q||null===(n=Q.query)||void 0===n?void 0:n.id)&&"62e82a1525ce0b00c334926e"!==(null===Q||void 0===Q||null===(t=Q.query)||void 0===t?void 0:t.id)&&"62f46c3d3715daa70c0d5853"!==(null===Q||void 0===Q||null===(r=Q.query)||void 0===r?void 0:r.id)||(Z.Am.error("You cant edit this user"),Q.push("/")),e.next=5,m().get("/user/".concat(null===Q||void 0===Q||null===(i=Q.query)||void 0===i?void 0:i.id));case 5:a=e.sent.data,W(a._id),N(a.name),F(a.email),O(a.website),P(a.role),L(a.image),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();(null===C||void 0===C?void 0:C.token)&&e()}),[C,null===Q||void 0===Q||null===(n=Q.query)||void 0===n?void 0:n.id]);var X=function(){var e=(0,r.Z)(l().mark((function e(n){var t,r,s,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=5,m().put("/update-user-by-".concat(h),{id:V,name:B,email:E,Website:D,password:U,role:M,image:(null===_||void 0===_||null===(t=_.selected)||void 0===t?void 0:t._id)?_.selected._id:(null===J||void 0===J?void 0:J._id)?J._id:void 0});case 5:(null===(r=e.sent.data)||void 0===r?void 0:r.error)?Z.Am.error(r.error):((null===C||void 0===C||null===(s=C.user)||void 0===s?void 0:s._id)===r._id&&(S((0,a.Z)((0,i.Z)({},C),{user:r})),(o=JSON.parse(localStorage.getItem("auth"))).user=r,localStorage.setItem("auth",JSON.stringify(o))),Z.Am.success("User updated successfully")),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),Z.Am.error("User update failed, Try again"),K(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}();return(0,o.jsx)(d.Z,{children:(0,o.jsxs)(p.Z,{span:12,offset:6,children:[(0,o.jsx)("h3",{style:{marginBottom:"-10px"},children:"Update user"}),(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),(0,o.jsx)("br",{}),(0,o.jsx)("div",{style:{marginBottom:20,textAlign:"center"},children:_.selected?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{marginBottom:15}}),(0,o.jsx)(v.C,{src:_.selected.url,size:100})]}):J?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{marginBottom:15}}),(0,o.jsx)(v.C,{src:J.url,size:100})]}):""}),"Subscriber"!==(null===C||void 0===C||null===(t=C.user)||void 0===t?void 0:t.role)&&(0,o.jsx)(y.Z,{}),(0,o.jsx)(x.Z,{style:{margin:"20px 0px 10px 0px"},size:"large",placeholder:"Full Name",value:B,onChange:function(e){return N(e.target.value)}}),(0,o.jsx)(x.Z,{style:{margin:"10px 0px 10px 0px"},size:"large",placeholder:"Email",value:E,onChange:function(e){return F(e.target.value)}}),(0,o.jsx)(x.Z,{style:{margin:"10px 0px 10px 0px"},size:"large",placeholder:"Website",value:D,onChange:function(e){return O(e.target.value)}}),"admin"===h&&(0,o.jsxs)(f.Z,{value:M,style:{margin:"20px 0px 10px 0px",width:"100%"},onChange:function(e){return P(e)},children:[(0,o.jsx)(f.Z.Option,{value:"Subscriber",children:" Subscriber "}),(0,o.jsx)(f.Z.Option,{value:"Author",children:" Author "}),(0,o.jsx)(f.Z.Option,{value:"Admin",children:" Admin "})]}),(0,o.jsx)(g.Z,{onClick:X,type:"default",style:{margin:"20px 0px 10px 0px"},loading:H,block:!0,children:"Submit"})]})})}}}]);