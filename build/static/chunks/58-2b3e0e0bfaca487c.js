(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[58],{69980:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(1413),a=n(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zm-377.1-44.1c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-.6-.6-1.3-1.2-2-1.7l-78.2-78.2a9.11 9.11 0 00-12.8 0l-48 48a9.11 9.11 0 000 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256zm12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"}}]},name:"bg-colors",theme:"outlined"},i=n(42135),l=function(e,t){return a.createElement(i.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:o}))};l.displayName="BgColorsOutlined";var c=a.forwardRef(l)},88484:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(1413),a=n(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},i=n(42135),l=function(e,t){return a.createElement(i.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:o}))};l.displayName="UploadOutlined";var c=a.forwardRef(l)},80275:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(1413),a=n(67294),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M759 335c0-137-111-248-248-248S263 198 263 335c0 82.8 40.6 156.2 103 201.2-.4.2-.7.3-.9.4-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00136 874.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C356 614.2 431 583 511 583c137 0 248-111 248-248zM511 507c-95 0-172-77-172-172s77-172 172-172 172 77 172 172-77 172-172 172zm105 221h264c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H703.5l47.2-60.1a8.1 8.1 0 001.7-4.9c0-4.4-3.6-8-8-8h-72.6c-4.9 0-9.5 2.3-12.6 6.1l-68.5 87.1c-4.4 5.6-6.8 12.6-6.8 19.8.1 17.7 14.4 32 32.1 32zm240 64H592c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h176.5l-47.2 60.1a8.1 8.1 0 00-1.7 4.9c0 4.4 3.6 8 8 8h72.6c4.9 0 9.5-2.3 12.6-6.1l68.5-87.1c4.4-5.6 6.8-12.6 6.8-19.8-.1-17.7-14.4-32-32.1-32z"}}]},name:"user-switch",theme:"outlined"},i=n(42135),l=function(e,t){return a.createElement(i.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:o}))};l.displayName="UserSwitchOutlined";var c=a.forwardRef(l)},27049:function(e,t,n){"use strict";var r=n(87462),a=n(4942),o=n(94184),i=n.n(o),l=n(67294),c=n(53124),s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};t.Z=function(e){var t,n=l.useContext(c.E_),o=n.getPrefixCls,u=n.direction,d=e.prefixCls,f=e.type,h=void 0===f?"horizontal":f,g=e.orientation,p=void 0===g?"center":g,v=e.orientationMargin,m=e.className,x=e.children,b=e.dashed,y=e.plain,Z=s(e,["prefixCls","type","orientation","orientationMargin","className","children","dashed","plain"]),w=o("divider",d),j=p.length>0?"-".concat(p):p,S=!!x,k="left"===p&&null!=v,C="right"===p&&null!=v,M=i()(w,"".concat(w,"-").concat(h),(t={},(0,a.Z)(t,"".concat(w,"-with-text"),S),(0,a.Z)(t,"".concat(w,"-with-text").concat(j),S),(0,a.Z)(t,"".concat(w,"-dashed"),!!b),(0,a.Z)(t,"".concat(w,"-plain"),!!y),(0,a.Z)(t,"".concat(w,"-rtl"),"rtl"===u),(0,a.Z)(t,"".concat(w,"-no-default-orientation-margin-left"),k),(0,a.Z)(t,"".concat(w,"-no-default-orientation-margin-right"),C),t),m),O=(0,r.Z)((0,r.Z)({},k&&{marginLeft:v}),C&&{marginRight:v});return l.createElement("div",(0,r.Z)({className:M},Z,{role:"separator"}),x&&l.createElement("span",{className:"".concat(w,"-inner-text"),style:O},x))}},1974:function(e,t,n){"use strict";var r=n(47568),a=n(14924),o=n(26042),i=n(69396),l=n(29815),c=n(34051),s=n.n(c),u=n(85893),d=n(67294),f=n(84551),h=n(16536),g=n(63922),p=n(67691),v=n(64082),m=n(18429),x=n(40730),b=n(4657),y=n(9669),Z=n.n(y),w=n(86501);t.Z=function(e){var t,n=e.page,c=void 0===n?"admin":n,y=f.Z.Dragger,j=(0,d.useContext)(x.V),S=j[0],k=(j[1],(0,d.useContext)(b.Y)),C=k[0],M=k[1],O=(0,d.useState)(!1),P=O[0];O[1],(0,d.useEffect)((function(){var e=function(){var e=(0,r.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z().get("/media");case 3:t=e.sent.data,M((function(e){return(0,i.Z)((0,o.Z)({},e),{images:t})})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var I={name:"file",action:"".concat("http://localhost:8000/api/","upload-image-file"),multiple:!0,headers:{Authorization:"Bearer ".concat(S.token)},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(h.ZP.success("".concat(e.file.name," file uploaded successfully")),M({images:(0,l.Z)(C.images).concat([e.file.response]),selected:e.file.response,showMediaModal:!1})):"error"===e.file.status&&h.ZP.error("".concat(e.file.name," file upload failed."))},onDrop:function(e){console.log("Dropped files",e.dataTransfer.files)}},N=function(){var e=(0,r.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z().delete("/media/".concat(t));case 3:n=e.sent.data,console.log(n),n.ok&&M((0,i.Z)((0,o.Z)({},C),{images:C.images.filter((function(e){return e._id!=t})),selected:null})),w.Am.error("Image Deleted successfully"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)(y,(0,i.Z)((0,o.Z)({},I),{accept:"image/*",children:[(0,u.jsx)("p",{className:"ant-upload-drag-icon",children:(0,u.jsx)(v.Z,{})}),(0,u.jsx)("p",{className:"ant-upload-text",style:{height:"85px"},children:"Click or drag file to this area to upload"})]})),(0,u.jsx)("br",{})]}),(0,u.jsxs)("div",{style:{textAlign:"center"},children:[null===C||void 0===C||null===(t=C.images)||void 0===t?void 0:t.map((function(e){var t,n,r;return(0,u.jsxs)(g.Z,{children:[(0,u.jsx)(p.Z,{onClick:function(){return M((0,i.Z)((0,o.Z)({},C),{selected:e}))},preview:P,style:(r={paddingTop:5,paddingRight:5},(0,a.Z)(r,"paddingTop",5),(0,a.Z)(r,"marginBottom",50),(0,a.Z)(r,"height","100px"),(0,a.Z)(r,"width","100px"),(0,a.Z)(r,"objectFit","cover"),(0,a.Z)(r,"cursor","pointer"),r),src:e.url}),(0,u.jsx)("br",{}),"author"===c&&(null===e||void 0===e||null===(t=e.postedBy)||void 0===t?void 0:t._id)==(null===S||void 0===S||null===(n=S.user)||void 0===n?void 0:n._id)||"admin"===c?(0,u.jsx)(m.Z,{onClick:function(){return N(e._id)},style:{color:"#f5222d "}}):""]})})),(0,u.jsx)("br",{})]})]})}},25030:function(e,t,n){"use strict";var r=n(85893),a=(n(67294),n(63456)),o=n(1974),i=n(74687),l=i.Z.TabPane;t.Z=function(){return(0,r.jsxs)(i.Z,{children:[(0,r.jsx)(l,{tab:"Upload File",children:(0,r.jsx)(a.Z,{})},"1"),(0,r.jsx)(l,{tab:"Media Library",children:(0,r.jsx)(o.Z,{})},"2")]})}},25889:function(e,t,n){"use strict";var r=n(47568),a=n(26042),o=n(69396),i=n(34051),l=n.n(i),c=n(85893),s=n(9835),u=n(71230),d=n(15746),f=n(27049),h=n(79531),g=n(71577),p=n(67691),v=n(14538),m=n(67294),x=n(6235),b=n(21364),y=n(9669),Z=n.n(y),w=n(76770),j=n.n(w),S=n(11163),k=n(86501),C=n(25030),M=n(4657),O=s.Z.Option,P=function(e){return new Promise((function(t){j().imageFileResizer(e,7200,400,"JPEG",100,0,(function(e){t(e)}),"base64")}))};!function(){var e=(0,r.Z)(l().mark((function e(t){var n,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P(t);case 3:return n=e.sent,console.log("image b64",n),e.next=7,Z().post("/upload-image",{image:n});case 7:return r=e.sent.data,console.log("Uploaded image: "+r),e.abrupt("return",r.url);case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))}();t.Z=function(e){var t,n=e.page,i=void 0===n?"admin":n,y=(0,S.useRouter)(),w=function(){var e=(0,r.Z)(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(!0),e.prev=1,e.next=5,Z().post("/create-post",{title:T,text:B,categories:U,featuredImage:null===z||void 0===z||null===(t=z.selected)||void 0===t?void 0:t._id});case 5:(null===(n=e.sent.data)||void 0===n?void 0:n.error)?(k.ZP.error(null===n||void 0===n?void 0:n.error),X(!1)):(console.log("POST PUBLISH RESS  =>",n),k.ZP.success("Post Created Successfully"),localStorage.removeItem("post-title"),_((0,o.Z)((0,a.Z)({},z),{selected:null})),localStorage.removeItem("post-content"),L([]),X(!1),y.push("/".concat(i,"/posts"))),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),k.ZP.error("Post Publish Failed"),X(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),j=(0,m.useState)("Welcome to NightKing-CMS"),P=j[0],I=j[1];(0,m.useEffect)((function(){localStorage.getItem("post-content")?I(JSON.parse(localStorage.getItem("post-content"))):I("<p> Welcome to NightKing-CMS, Start Bloggin now in Markup </p>")}),[]),(0,m.useRef)(null);var N=(0,m.useContext)(b.N),E=(N[0],N[1],(0,m.useContext)(M.Y)),z=E[0],_=E[1],R=(0,m.useState)(localStorage.getItem("post-content")?JSON.parse(localStorage.getItem("post-content")):"This is your initial text"),B=R[0],A=R[1],F=(0,m.useState)(function(){if(localStorage.getItem("post-title"))return JSON.parse(localStorage.getItem("post-title"))}()),T=F[0],H=F[1],D=(0,m.useState)([]),U=D[0],L=D[1],V=(0,m.useState)([]),J=V[0],W=V[1],K=(0,m.useState)(!1),G=K[0],Q=K[1],Y=(0,m.useState)(!1),$=(Y[0],Y[1],(0,m.useState)(!1)),q=$[0],X=$[1];(0,m.useEffect)((function(){ee()}),[]);var ee=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z().get("/categories");case 3:t=e.sent.data,W(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return(0,c.jsxs)(u.Z,{children:[(0,c.jsxs)(d.Z,{span:14,offset:1,children:[(0,c.jsx)(f.Z,{children:" Create New Post"}),(0,c.jsx)("br",{}),(0,c.jsx)(h.Z,{value:T,placeholder:"Give you Post a Title",onChange:function(e){H(e.target.value),localStorage.setItem("post-title",JSON.stringify(e.target.value))}}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),(0,c.jsx)(x.M,{apiKey:"g7wekghh9n4a5vw9pjog2yglr9kgert1sy9zlxcxvnyj0o9n",init:{selector:"textarea",skin:"oxide-dark",content_css:"dark",menubar:!0,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","code","help","wordcount"],toolbar:"undo redo | link image | code | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }",file_picker_types:"file image media",block_unsupported_drop:!1},initialValue:P,onEditorChange:function(e){A(e),localStorage.setItem("post-content",JSON.stringify(e))}})]}),(0,c.jsxs)(d.Z,{span:6,offset:1,children:[(0,c.jsx)(g.Z,{style:{margin:"10px 0px 10px 0px",width:"100%"},onClick:function(){return Q(!0)},children:" Preview"}),(0,c.jsx)("h4",{children:" Categories "}),(0,c.jsx)(s.Z,{mode:"multiple",allowClear:!0,placeholder:"Select Categories",style:{width:"100%"},onChange:function(e){return L(e)},children:J.map((function(e){return(0,c.jsx)(O,{children:e.name},e.name)}))}),(0,c.jsx)("br",{}),(0,c.jsx)("br",{}),(null===z||void 0===z?void 0:z.selected)&&(0,c.jsx)(p.Z,{width:"100%",src:null===z||void 0===z||null===(t=z.selected)||void 0===t?void 0:t.url}),(0,c.jsx)(g.Z,{style:{margin:"10px 0px 10px 0px",width:"100%"},onClick:function(){return _((0,o.Z)((0,a.Z)({},z),{showMediaModal:!0}))},children:"Featured Image"}),(0,c.jsx)(v.Z,{title:"Media",visible:z.showMediaModal,onOk:function(){return _((0,o.Z)((0,a.Z)({},z),{showMediaModal:!1}))},onCancel:function(){return _((0,o.Z)((0,a.Z)({},z),{showMediaModal:!1}))},footer:null,width:720,children:(0,c.jsx)(C.Z,{})}),(0,c.jsx)(g.Z,{style:{margin:"10px 0px 10px 0px",width:"100%"},type:"primary",loading:q,onClick:w,children:" Publish"})]}),(0,c.jsxs)(v.Z,{title:"Preview",centered:!0,visible:G,onOk:function(){return Q(!1)},onCancel:function(){return Q(!1)},footer:null,width:720,children:[(0,c.jsxs)("h1",{children:[" ",T," "]}),(0,c.jsx)(x.M,{init:{selector:"textarea",skin:"oxide-dark",content_css:"dark",menubar:!1,readonly:!0},toolbar:"false",initialValue:B})]})]})}},76770:function(e){(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};t.r(n),t.d(n,{default:()=>a});var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return t=[{key:"changeHeightWidth",value:function(e,t,n,r,a,o){return n>r&&(e=Math.round(e*r/n),n=r),e>t&&(n=Math.round(n*t/e),e=t),a&&n<a&&(e=Math.round(e*a/n),n=a),o&&e<o&&(n=Math.round(n*o/e),e=o),{height:e,width:n}}},{key:"resizeAndRotateImage",value:function(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=i/100,s=document.createElement("canvas"),u=e.width,d=e.height,f=this.changeHeightWidth(d,n,u,t,r,a);!l||90!==l&&270!==l?(s.width=f.width,s.height=f.height):(s.width=f.height,s.height=f.width),u=f.width,d=f.height;var h=s.getContext("2d");return h.fillStyle="rgba(0, 0, 0, 0)",h.fillRect(0,0,u,d),h.imageSmoothingEnabled&&h.imageSmoothingQuality&&(h.imageSmoothingQuality="high"),l&&(h.rotate(l*Math.PI/180),90===l?h.translate(0,-s.width):180===l?h.translate(-s.width,-s.height):270===l?h.translate(-s.height,0):0!==l&&360!==l||h.translate(0,0)),h.drawImage(e,0,0,u,d),s.toDataURL("image/".concat(o),c)}},{key:"b64toByteArrays",value:function(e,t){t=t||"image/jpeg";for(var n=atob(e.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),r=[],a=0;a<n.length;a+=512){for(var o=n.slice(a,a+512),i=new Array(o.length),l=0;l<o.length;l++)i[l]=o.charCodeAt(l);var c=new Uint8Array(i);r.push(c)}return r}},{key:"b64toBlob",value:function(e,t){var n=this.b64toByteArrays(e,t);return new Blob(n,{type:t,lastModified:new Date})}},{key:"b64toFile",value:function(e,t,n){var r=this.b64toByteArrays(e,n);return new File(r,t,{type:n,lastModified:new Date})}},{key:"createResizedImage",value:function(t,n,r,a,o,i,l){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=new FileReader;if(!t)throw Error("File Not Found!");if(t.type&&!t.type.includes("image"))throw Error("File Is NOT Image!");d.readAsDataURL(t),d.onload=function(){var f=new Image;f.src=d.result,f.onload=function(){var d=e.resizeAndRotateImage(f,n,r,s,u,a,o,i),h="image/".concat(a);switch(c){case"blob":var g=e.b64toBlob(d,h);l(g);break;case"base64":default:l(d);break;case"file":var p=t.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(a.toString()),v=e.b64toFile(d,p,h);l(v)}}},d.onerror=function(e){throw Error(e)}}}],t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e,t),e}();const a={imageFileResizer:function(e,t,n,a,o,i,l,c,s,u){return r.createResizedImage(e,t,n,a,o,i,l,c,s,u)}};e.exports=n})()}}]);